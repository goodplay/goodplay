machine:
  services:
    - docker

  post:
    # install vagrant
    - sudo wget --quiet https://dl.bintray.com/mitchellh/vagrant/vagrant_1.7.3_x86_64.deb
    - sudo dpkg -i vagrant_1.7.3_x86_64.deb

dependencies:
  override:
    - pip install codecov tox

test:
  override:
    - tox
    - mkdir -p $CIRCLE_TEST_REPORTS/junit/
    - cp artifacts/test/junit-*.xml $CIRCLE_TEST_REPORTS/junit/

    - tox -e codecov-prepare
    - codecov --file artifacts/coverage/coverage.xml || true
